# Atom Game 规则说明

## 一、游戏概述

Atom Game 是一款双人回合制对战游戏。双方通过将拥有的原子（黑、红、蓝、绿四种）按特定结构排布在场上，向对方发动攻击或发动效果，将对方生命值降至 0 即获胜。

---

## 二、游戏布局

### 2.1 原子区域

- 双方各有**原子持有区**，记录当前拥有的四种原子数量：黑、红、蓝、绿。

### 2.2 场地区域

- 双方各有**场地区域**，结构如下：
  - 每方场地有 **3 个格子**（cell）。
  - 每个格子对应一个**几何空间**，由**正三角形网格**构成。
  - 三角形底边平行于双方玩家的中场分界线。
  - **竖向**为“高”，**横向**为“宽”。
  - 三角形**边长 = 1**，**高 = √3/2**。
  - 玩家在**格点**上放置原子。

### 2.3 坐标系与相邻

- 使用**三角形–格点二维索引**表示格点坐标。
- “竖向”严格沿三角形高的方向，“横向”严格沿底边方向。
- **相邻**：每个格点的邻居是**与其几何距离为 1 的六个格点**（即正三角形网格中共享边的六个最近节点）。

---

## 三、初始状态

- 每方**生命值**：20。
- 每方**初始原子**：**7 黑 + 1 红 + 1 蓝 + 1 绿**，共 10 个。

---

## 四、回合流程

轮到玩家 A 时，按以下阶段依次进行。

### 阶段 0：确认场上状态

- 记玩家 A 场上**非空格子数**为 **x**（即有原子的格子数量，1～3）。
- 玩家 A **必须且只能**选择以下效果之一：
  - **(a)** 本回合获取原子阶段可获得 **5 + x** 个原子（否则为 5 个）；
  - **(b)** 本回合排布阶段最多可放置 **4 + x** 个原子（否则为 4 个）；
  - **(c)** 本回合动作阶段可发动 **x** 次进攻（否则为 1 次）。

### 阶段 1：获取原子

- 玩家 A 随机获得一定数量的原子：
  - 若阶段 0 选择了 **(a)**：获得 **5 + x** 个；
  - 否则：获得 **5** 个。
- **随机概率**：
  - **黑**：1/2
  - **红**：1/6
  - **蓝**：1/6
  - **绿**：1/6

### 阶段 2：排布阶段

- 玩家 A 将最多一定数量的原子放置在自己场上的 3 个格子的格点中：
  - 若阶段 0 选择了 **(b)**：最多 **4 + x** 个；
  - 否则：最多 **4** 个。
- **约束**：
  - 一个格点只能放置一个原子。
  - 相邻格点若都存在原子，则形成一条边。
  - 同一个格子内的多个原子必须**连通**。
  - 每个**非空**格子中至少需要存在**一个黑原子**。

### 阶段 3：动作阶段

- 本阶段可进行两种动作，**动作 2 次数不限**，可在多次**动作 1** 之间穿插进行。
- **动作 1：进攻**
  - 可发动次数：若阶段 0 选择了 **(c)** 则为 **x** 次，否则为 **1** 次。
  - 每次进攻：选择己方一个**存在原子的格子**，攻击对方一个**存在原子的格子**。
  - 若对方场上**三格全空**，则可**直接攻击玩家**（见下）。
- **动作 2：发动效果**
  - 通过**移除**己方场上的红、蓝、绿原子发动效果（见下），发动次数不限。

---

## 五、格子持续性效果

每个格子内红、绿、蓝原子的数量会带来持续效果（仅在该格参与攻防时生效）：

| 颜色 | 数量 n | 效果 |
|------|--------|------|
| 红   | n 个   | 攻击时能**多破坏 n 个**原子（在“可指定破坏 1 个黑原子”的基础上增加名额） |
| 绿   | n 个   | 被攻击时，对**玩家造成的伤害**减少 n（不低于 0） |
| 蓝   | n 个   | 被攻击时，**被破坏的原子数目**减少 n（不低于 0） |

---

## 六、进攻（动作 1）详细规则

- 攻击形式为**单格对单格**：一次进攻只涉及己方一个格子与对方一个格子。

### 6.1 攻击力与防御力

- **攻击力**（进攻格）：该格中**最高黑原子**与**最低黑原子**的**竖向距离**，单位为三角形高（√3/2），即该距离是 √3/2 的多少倍，攻击力即为多少。
- **防御力**（防守格）：该格中**最左黑原子**与**最右黑原子**的**横向距离**，单位为边长 1，即该距离的倍数即为防御力。

### 6.2 攻击结算（格对格）

- 若 **攻击力 > 防御力**：
  1. 进攻方选择防守格中的**一个黑原子**，将其破坏。
  2. 若该格有红原子，则进攻方可额外破坏的原子数 + 该格红原子数；防守格蓝原子数会减少“被破坏原子数”（最终破坏数不低于 0）。
  3. 若此次破坏导致防守格内原子不再连通，则防守方**必须**选择一个**包含至少一个黑原子**的连通子集保留，其余连通子集上的原子**全部破坏**。若不存在包含黑原子的连通子集，则该格**所有原子**全部破坏。

### 6.3 直接攻击玩家

- 当对方场上**三格全空**时，进攻方可以**直接攻击玩家**。
- 对方受到的**伤害 = 进攻方所选格子的攻击力**。
- **直接攻击的伤害**不受对方场上绿原子等防御修正影响（即不看对方格子）。

---

## 七、发动效果（动作 2）详细规则

- 通过**移除**己方场上的一个红、蓝或绿原子来发动效果。
- 移除时，根据该原子**与黑色原子连边的数量 y**（即相邻黑原子个数）结算：

| 移除原子 | 效果 |
|----------|------|
| 红       | 对方必须从自己场上选择 **y 个原子**破坏（可含黑，无“每格至少留一黑”限制）。若某格在破坏后**没有任何黑原子**，则该格**全部原子**破坏。 |
| 蓝       | 己方获得 **y 个黑原子**（加入原子持有区）。 |
| 绿       | 己方恢复 **y 点生命**。 |

- 发动次数不限，且可在不同次进攻之间穿插进行。

---

## 八、额外规定

- **先手第一回合**：第一个回合的先手玩家**不能发动攻击**（即不能执行动作 1），只能进行获取原子、排布与发动效果。

---

## 九、胜负

- 当一方生命值降至 **0** 或以下时，对方获胜。
